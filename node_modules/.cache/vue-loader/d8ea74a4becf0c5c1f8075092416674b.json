{"remainingRequest":"/Users/gdezheleha/Documents/refresh/refresh/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/gdezheleha/Documents/refresh/refresh/src/components/commonComponents/ImageClip/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/gdezheleha/Documents/refresh/refresh/src/components/commonComponents/ImageClip/index.vue","mtime":1574166803776},{"path":"/Users/gdezheleha/Documents/refresh/refresh/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/gdezheleha/Documents/refresh/refresh/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/gdezheleha/Documents/refresh/refresh/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/gdezheleha/Documents/refresh/refresh/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIGltcG9ydCBjaGFuZ2VQcm9wIGZyb20gJy4uLy4uL1B1cGlsQ2FyZC9taXhpbnMvY2hhbmdlUHJvcHMnCgpleHBvcnQgZGVmYXVsdCB7CiAgLy8gbWl4aW5zOiBbY2hhbmdlUHJvcF0sCiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBibG9iUmVzdWx0OiBudWxsLAogICAgICBmaWxlOiBudWxsLAogICAgICBpc1Nob3duQ2xpcHBlcjogdHJ1ZSwKICAgICAgZGlydHk6IGZhbHNlLAogICAgICBpbWFnZTogewogICAgICAgIGJhc2U2NDogbnVsbCwKICAgICAgICBibG9iT2JqOiBudWxsCiAgICAgIH0sCiAgICAgIGVycm9yTXNnOiAnJywKICAgICAgZGVmYXVsdEVycm9yTXNnOiAn0KbQtSDQv9C+0LvQtSDQvtCx0L7QstGP0LfQutC+0LLQtScsCiAgICAgIGJpZ2dlckltZ0Vycm9yTXNnOiAn0KDQvtC30LzRltGAINGE0L7RgtC+INC/0LXRgNC10LLQuNGJ0YPRlCDQtNC+0LfQstC+0LvQtdC90LjQuScsCiAgICAgIHNtYWxsZXJJbWdFcnJvck1zZzogJ9Cv0LrRltGB0YLRjCDRhNC+0YLQviDQvdC40LbRh9C1INC90ZbQtiDQv9C+0YLRgNGW0LHQvdC+JywKICAgICAgZXJyb3JNc2dUeXBlOiAxLAogICAgICBtaW5JbWdXaWR0aDogNDgwLAogICAgICBtaW5JbWdIZWlnaHQ6IDY0MAogICAgfQogIH0sCiAgcHJvcHM6IHsKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGNhbmNlbEltYWdlICgpIHsKICAgICAgdGhpcy5maWxlID0gbnVsbAogICAgICB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldFVzZXIucGVyc29uUGhvdG8gPSBudWxsCiAgICB9LAogICAgYXN5bmMgY2xpcEltZyAoKSB7CiAgICAgIGNvbnN0IGNhbnZhcyA9IHRoaXMuJHJlZnMuY2xpcHBlci5jbGlwKCkvLyBjYWxsIGNvbXBvbmVudCdzIGNsaXAgbWV0aG9kCiAgICAgIGNvbnN0IHF1YWxpdHkgPSAwLjk1CiAgICAgIC8vIHZhbGlkYXRpb24KICAgICAgdGhpcy52YWx1ZS5pc0RpcnR5RmlsZSA9IHRydWUKICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCB0aGlzLnZhbHVlKQoKICAgICAgLy8gaGlkZSBjbGlwcGVyIGJsb2NrCiAgICAgIHRoaXMuaXNTaG93bkNsaXBwZXIgPSBmYWxzZQoKICAgICAgLy8gY2hlY2sgaW1nIHNpemUKICAgICAgY29uc3QgaW1hZ2VTaXplID0gY2FudmFzLmhlaWdodCAqIGNhbnZhcy53aWR0aAogICAgICBjb25zdCBpc0FsbG93ZWRJbWFnZVNpemUgPSB0aGlzLmlzQWxsb3dlZEltYWdlU2l6ZShpbWFnZVNpemUpCgogICAgICBpZiAoaXNBbGxvd2VkSW1hZ2VTaXplKSB7CiAgICAgICAgY2FudmFzLnRvQmxvYihibCA9PiB7CiAgICAgICAgICAvLyB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldFVzZXIucGVyc29uUGhvdG8gPSBibDsKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGJsKTsKICAgICAgICAgIHRoaXMuZW1pdERhdGFUb1BhcmVudChibCkKICAgICAgICB9LCAnaW1hZ2UvanBlZycsIHF1YWxpdHkpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gdGhpcy5maWxlID0gbnVsbDsKICAgICAgfQogICAgfSwKICAgIGlzQWxsb3dlZEltYWdlU2l6ZSAoaW1hZ2VTaXplKSB7CiAgICAgIGNvbnN0IG1pbiA9IHRoaXMubWluSW1nV2lkdGggKiB0aGlzLm1pbkltZ0hlaWdodAogICAgICBjb25zdCBtYXggPSA0MDk2ICogNDA5NgoKICAgICAgaWYgKGltYWdlU2l6ZSA+IG1heCkgewogICAgICAgIHRoaXMuZXJyb3JNc2dUeXBlID0gMgogICAgICAgIHRoaXMudmFsdWUuaXNWYWxpZEZpbGUgPSBmYWxzZQogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9IGVsc2UgaWYgKGltYWdlU2l6ZSA8IG1pbikgewogICAgICAgIHRoaXMudmFsdWUuaXNWYWxpZEZpbGUgPSBmYWxzZQogICAgICAgIHRoaXMuZXJyb3JNc2dUeXBlID0gMwogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZXJyb3JNc2dUeXBlID0gMQogICAgICB9CiAgICAgIHJldHVybiB0cnVlCiAgICB9LAogICAgZW1pdERhdGFUb1BhcmVudCAoYmwpIHsKICAgICAgdGhpcy4kZW1pdCgnc2F2ZS1pbWFnZScsIGJsKQogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIGZpbGUgKG5ld1ZhbCwgb2xkVmFsKSB7CiAgICAgIHRoaXMudmFsdWUuaXNWYWxpZEZpbGUgPSAhIW5ld1ZhbAoKICAgICAgdGhpcy52YWx1ZS5pc0RpcnR5RmlsZSA9IHRydWUKICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCB0aGlzLnZhbHVlKQoKICAgICAgLy8gc2hvdyBjbGlwcGVyIGJsb2sKICAgICAgaWYgKG5ld1ZhbCAmJiBvbGRWYWwpIHsKICAgICAgICB0aGlzLmlzU2hvd25DbGlwcGVyID0gdHJ1ZQogICAgICB9CiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgdXBsb2FkQnV0dG9uVGV4dCAoKSB7CiAgICAgIHJldHVybiB0aGlzLmZpbGUgPyAn0IbQvdGI0LUg0YTQvtGC0L4nIDogJ9CX0LDQstCw0L3RgtCw0LbQuNGC0Lgg0YTQvtGC0L4nCiAgICB9LAogICAgaXNTaG93bkVycm9yTXNnICgpIHsKICAgICAgcmV0dXJuIHRoaXMudmFsdWUuaXNEaXJ0eUZpbGUgPT09IHRydWUgJiYgdGhpcy52YWx1ZS5pc1ZhbGlkRmlsZSA9PT0gZmFsc2UKICAgIH0sCiAgICBnZXRFcnJvck1zZyAoKSB7CiAgICAgIHN3aXRjaCAodGhpcy5lcnJvck1zZ1R5cGUpIHsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0RXJyb3JNc2cKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMjoKICAgICAgICAgIHJldHVybiB0aGlzLmJpZ2dlckltZ0Vycm9yTXNnCiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlIDM6CiAgICAgICAgICByZXR1cm4gdGhpcy5zbWFsbGVySW1nRXJyb3JNc2cKICAgICAgICAgIGJyZWFrOwogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0RXJyb3JNc2cKICAgICAgfQogICAgfQogIH0KfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6EA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/commonComponents/ImageClip","sourcesContent":["<template>\n    <div class=\"inputPhoto\">\n        <div id=\"img1\">\n\n        </div>\n        <!--image upload data-->\n\n        <div\n                class=\"img-requirements\"\n                v-show=\"!file || !isShownClipper\"\n        >\n            <h6>\n                Фотографія повинна відповідати наступним вимогам\n            </h6>\n            <ol>\n                <li\n                        v-for=\"(elem, index) in $store.getters.getImageRequirements\"\n                        :key=\"index\"\n                >\n                    {{elem}}\n                </li>\n            </ol>\n        </div>\n\n        <div class=\"before-upload\" id=\"image-clipper\">\n            <div class=\"photo-example\">\n                <img v-if=\"!file \" src=\"../../../assets/PersonPhoto.png\" alt=\"Person photo example\">\n                <clipper-preview v-else name=\"my-preview\" class=\"my-clipper\">\n                </clipper-preview>\n            </div>\n            <div class=\"upload-info--wrap\">\n                <!--<div class=\"col-md-12\">-->\n                <div class=\"col-md-12 upload-info\">\n                    <p>\n                        Формат: .jpg файл<br>\n                        Розмір: Мах. 1mb, Min. {{minImgWidth}}х{{minImgHeight}}\n                    </p>\n                    <span\n                            class=\"error-msg\"\n                            v-if=\"isShownErrorMsg\"\n                    >\n                        <!--Це поле обовязкове-->\n                        {{getErrorMsg}}\n                    </span>\n                </div>\n                <clipper-upload v-model=\"file\" accept=\"image/*\" class=\"upload-btn\">\n                    <button type=\"button\" class=\"btn btn-pink\">\n                        {{uploadButtonText}}\n                    </button>\n                </clipper-upload>\n            </div>\n        </div>\n\n        <div v-if=\"isShownClipper\">\n            <div\n                    class=\"col-md-12 clipper\"\n            >\n                <clipper-basic\n                        :ratio=\"3/4\"\n                        :src=\"file\"\n                        ref=\"clipper\"\n                        preview=\"my-preview\"\n                ></clipper-basic>\n            </div>\n            <div class=\"col-md-12 clip-btn-wrap\" v-if=\"file\">\n                <button class=\"btn btn-cancel\" type=\"button\" @click=\"cancelImage\">\n                    Скасувати\n                </button>\n                <button type=\"button\" class=\"btn btn-pink\" @click=\"clipImg\">\n                    Зберегти фото\n                </button>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\n// import changeProp from '../../PupilCard/mixins/changeProps'\n\nexport default {\n  // mixins: [changeProp],\n  data () {\n    return {\n      blobResult: null,\n      file: null,\n      isShownClipper: true,\n      dirty: false,\n      image: {\n        base64: null,\n        blobObj: null\n      },\n      errorMsg: '',\n      defaultErrorMsg: 'Це поле обовязкове',\n      biggerImgErrorMsg: 'Розмір фото перевищує дозволений',\n      smallerImgErrorMsg: 'Якість фото нижче ніж потрібно',\n      errorMsgType: 1,\n      minImgWidth: 480,\n      minImgHeight: 640\n    }\n  },\n  props: {\n    value: {\n      type: Object,\n      required: true\n    }\n  },\n  methods: {\n    cancelImage () {\n      this.file = null\n      this.$store.getters.getUser.personPhoto = null\n    },\n    async clipImg () {\n      const canvas = this.$refs.clipper.clip()// call component's clip method\n      const quality = 0.95\n      // validation\n      this.value.isDirtyFile = true\n      this.$emit('input', this.value)\n\n      // hide clipper block\n      this.isShownClipper = false\n\n      // check img size\n      const imageSize = canvas.height * canvas.width\n      const isAllowedImageSize = this.isAllowedImageSize(imageSize)\n\n      if (isAllowedImageSize) {\n        canvas.toBlob(bl => {\n          // this.$store.getters.getUser.personPhoto = bl;\n          // console.log(bl);\n          this.emitDataToParent(bl)\n        }, 'image/jpeg', quality)\n      } else {\n        // this.file = null;\n      }\n    },\n    isAllowedImageSize (imageSize) {\n      const min = this.minImgWidth * this.minImgHeight\n      const max = 4096 * 4096\n\n      if (imageSize > max) {\n        this.errorMsgType = 2\n        this.value.isValidFile = false\n        return false\n      } else if (imageSize < min) {\n        this.value.isValidFile = false\n        this.errorMsgType = 3\n        return false\n      } else {\n        this.errorMsgType = 1\n      }\n      return true\n    },\n    emitDataToParent (bl) {\n      this.$emit('save-image', bl)\n    }\n  },\n  watch: {\n    file (newVal, oldVal) {\n      this.value.isValidFile = !!newVal\n\n      this.value.isDirtyFile = true\n      this.$emit('input', this.value)\n\n      // show clipper blok\n      if (newVal && oldVal) {\n        this.isShownClipper = true\n      }\n    }\n  },\n  computed: {\n    uploadButtonText () {\n      return this.file ? 'Інше фото' : 'Завантажити фото'\n    },\n    isShownErrorMsg () {\n      return this.value.isDirtyFile === true && this.value.isValidFile === false\n    },\n    getErrorMsg () {\n      switch (this.errorMsgType) {\n        case 1:\n          return this.defaultErrorMsg\n          break;\n        case 2:\n          return this.biggerImgErrorMsg\n          break;\n        case 3:\n          return this.smallerImgErrorMsg\n          break;\n        default:\n          return this.defaultErrorMsg\n      }\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n    .inputPhoto {\n        width: 100%;\n        justify-content: center;\n        margin-bottom: 12px;\n\n        img {\n            margin-bottom: 20px;\n            /*width: 62px !important;*/\n            width: 100%;\n            height: auto;\n            max-height: 300px;\n            object-fit: cover;\n        }\n    }\n\n    .clip-btn-wrap {\n        /*padding-bottom: 20px;*/\n    }\n\n    .before-upload {\n        display: flex;\n    }\n\n    .photo-example {\n        width: 100%;\n        max-width: 87px;\n        margin-left: 40px;\n        margin-top: 16px;\n        height: auto;\n        max-height: 116px;\n        object-fit: cover;\n\n        img {\n            width: 100%;\n            height: auto;\n            object-fit: cover;\n            /*max-width: 54px;*/\n        }\n    }\n\n    .upload-info--wrap {\n        width: 100%;\n        padding-left: 33px;\n    }\n\n    .upload-info {\n        margin-top: 26px;\n        padding-left: 0;\n\n        p {\n            color: #000000;\n            font-family: Calibri;\n            font-size: 16px;\n            text-align: left;\n            font-weight: 400;\n        }\n    }\n\n    .upload-btn {\n        width: 100%;\n\n        button {\n            margin: 0;\n            -webkit-border-radius: 3px;\n            -moz-border-radius: 3px;\n            border-radius: 3px;\n        }\n    }\n\n    .btn-cancel {\n        border: 1px solid #b54285;\n        color: #434343;\n        font-family: \"Century Gothic\";\n        font-size: 16px;\n        font-weight: 700;\n        cursor: pointer;\n\n        &:hover {\n            color: white;\n            background-color: #d967a7;\n        }\n    }\n\n    .img-requirements {\n        h6 {\n            margin-top: 10px;\n            text-align: center;\n            font-size: 16px;\n            font-family: Calibri;\n        }\n\n        ol {\n            width: 100%;\n            padding-left: 20px;\n            margin-top: 15px;\n        }\n\n        li {\n            width: 100%;\n            font-size: 14px;\n            line-height: 1.2em;\n            font-family: Calibri;\n            color: #000;\n        }\n    }\n\n    .clipper {\n        margin-top: 27px;\n    }\n\n    @media screen and (max-width: 540px) {\n        .photo-example {\n            margin-left: 20px;\n        }\n    }\n\n    @media screen and (max-width: 430px) {\n        .upload-info--wrap {\n            padding-left: 10px;\n        }\n        .upload-btn {\n            button {\n                width: 100%;\n            }\n        }\n    }\n\n    @media screen and (max-width: 325px) {\n        .photo-example {\n            margin-left: 10px;\n        }\n    }\n</style>\n"]}]}